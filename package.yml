name       : fceux
version    : 2.6.3
release    : 8
source     :
    - https://downloads.sourceforge.net/project/fceultra/Source%20Code/2.6.3%20src/fceux-2.6.3.tar.gz : 410113e0437af2c1f041e1f1d48876f15d4b77de7b04c92c84e1d99c870393ad
license    : GPL-2.0-later
component  : games.emulator
summary    : NES/Famicom Emulator
description: |
    FCEUX is a Nintendo Entertainment System (NES), Famicom, Famicom Disk System (FDS), and Dendy emulator. It supports PAL (European), NTSC (USA/JPN), and Hybrid (PAL) modes.
builddeps  :
    - pkgconfig(lua-5.1)
    - pkgconfig(minizip)
    - pkgconfig(opengl)
    - pkgconfig(Qt6Widgets)
    - pkgconfig(sdl2)
setup      : |
    %patch -p1 < $pkgfiles/0001-Allow-defaults-for-native-file-dialog-and-native-men.patch
    sed -i 's*//#define PUBLIC_RELEASE*#define PUBLIC_RELEASE*' src/version.h
    %cmake_ninja -DGLVND=true -DUSE_NATIVE_FILE_DIALOG=true -DQT6=true
build      : |
    %ninja_build
install    : |
    %ninja_install

    # Make fceux work with icon themes
    mv $installdir/usr/share/pixmaps/fceux1.png $installdir/usr/share/pixmaps/fceux.png
    install -Dm00644 $pkgfiles/fceux.desktop $installdir/usr/share/applications/fceux.desktop
